# 프로토콜
HTTP/2에서 따옴

# 메시지 매니저, 메모리 풀
메시지 종류별 크기 구분 없이 고정된 크기로 메모리 풀 할당

메시지 헤더 14 바이트

(ChattingMessage(151 bytes), FriendMessage(51 bytes) => 구분 없이 192bytes 할당)  
대용량 파일 송수신 같은 큰 메시지의 경우, 별도의 메모리 할당(슬롯당 192 * 10 = 1920 bytes)  

버퍼 매니저는 한 번에 1M개 까지 존재

메시지 매니저한테 버퍼 할당 192 바이트 씩.  
메시지매니저는, 바이트 수신 받을 때, 먼저 14바이트 저장하면서 읽고, 페이로드 길이에 따라 나머지 바이트 저장을 처리  
(그냥 저장, 일부 저장 후 새 버퍼 할당받고서 저장)  

지금 구조면, 유저메모리에서의 한 번의 복사가 일어나게 됨(소켓에 할당한 메모리 -> 메시지 매니저 메모리)  
소켓에 할당한 메모리에서 바로 데이터를 유효하게 사용하려면 해당 스트림을 바로 파싱해야하는데 그럼 구조간에 많이 종속적이게 됨  
이 때 방법 1. 헤더 만큼의 버퍼를 할당해서 읽고, 페이로드 만큼의 버퍼를 할당해서 읽고(C#프로젝트에서 한 방식)  
방법 2. 큰 메모리 버퍼에서 메시지를 연속적으로 받아서 사용하다가, 마지막에 메시지 자리가 부족하면 해당 스트림부분만 일부 복사해서 사용

일단 복사하는 방향으로 만들어놓고, 나중에 수정해보기로  